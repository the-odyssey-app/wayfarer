# Quest Completion Flow Tests
# Tests complete quest flow from start to finish

appId: com.wayfarer.mobile
tags:
  - critical
  - quests

---
# Test 1: Start Quest
- launchApp
- assertVisible:
    id: "home_screen"
- assertNotVisible:
    id: "login_screen"
# Navigate to quest detail
- tapOn:
    id: "quest_card_0"
    optional: true
- assertVisible:
    id: "quest_detail_screen"
    optional: true
- tapOn:
    id: "join_quest_button"
    optional: true
- waitForAnimationToEnd
# Verify quest started (quest detail should show active state)
- assertVisible:
    id: "quest_detail_screen"
    optional: true

---
# Test 2: Complete Quest Steps (Simplified - Complete First Step)
- launchApp
- assertVisible:
    id: "home_screen"
- assertNotVisible:
    id: "login_screen"
# Navigate to active quest
- tapOn:
    id: "quest_card_0"
    optional: true
- assertVisible:
    id: "quest_detail_screen"
    optional: true
# Complete first step (if available)
- tapOn:
    text: ".*[Cc]omplete.*[Ss]tep.*|.*[Cc]omplete.*"
    optional: true
# Verify step completion
- assertVisible:
    text: ".*[Cc]omplete.*|.*[Nn]ext.*|.*[Ss]tep.*2.*"
    optional: true

---
# Test 3: Quest Completion Screen
- launchApp
- assertVisible:
    id: "home_screen"
- assertNotVisible:
    id: "login_screen"
# Navigate to completed quest (if available in history)
- tapOn:
    text: ".*[Hh]istory.*|.*[Cc]ompleted.*"
    optional: true
# Verify completion screen elements
- assertVisible:
    text: ".*[Cc]omplete.*|.*[Xx][Pp].*|.*[Rr]ating.*"
    optional: true

---
# Test 4: Submit Rating
- launchApp
- assertVisible:
    id: "home_screen"
- assertNotVisible:
    id: "login_screen"
# Navigate to completed quest
- tapOn:
    text: ".*[Hh]istory.*|.*[Cc]ompleted.*"
    optional: true
- tapOn:
    text: ".*[Rr]ate.*|.*[Rr]ating.*"
    optional: true
# If rating modal appears
- assertVisible:
    text: ".*[Rr]ating.*|.*[Ss]tar.*"
    optional: true
- tapOn:
    point: "70%,50%"
    optional: true
# Submit rating
- tapOn:
    text: ".*[Ss]ubmit.*|.*[Ss]ave.*"
    optional: true
